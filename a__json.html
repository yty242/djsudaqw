<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Poor+Story&display=swap" rel="stylesheet">
  <style>
.poor-story-regular {
  font-family: "Poor Story", system-ui;
  font-weight: 400;
  font-style: normal;
}


 a {  
  font-family: "Poor Story", system-ui;
  font-weight: 400;
  font-style: normal;}


    .container {
      overflow: hidden;
    }

    .filterDiv {
      float: left;
      background-color: #ddd;
      color: #ffffff;
      width: 206px;
      height: 300px;
      line-height: 100px;
      text-align: center;
      margin: 2px;
      display: inline-block; /* 수정된 부분 */
    }

    /* The "show" class is added to the filtered elements */
    .show {
      display: block;
    }

    /* Style the buttons */
    .btn {
      border: none;
      outline: none;
      padding: 12px 16px;
      background-color: #f1f1f1;
      cursor: pointer;
    }

    /* Add a light grey background on mouse-over */
    .btn:hover {
      background-color: #ddd;
    }

    /* Add a dark background to the active button */
    .btn.active {
      background-color: #666;
      color: white;
    }

    img {
      width: 200px; height:200px;
    }

    .filterDiv {
      position: relative;
      overflow: hidden;
    }

    .filterDiv a {
      display: block;
      width: 100%; /* 부모 요소의 전체 너비를 사용 */
      height: 100%; /* 부모 요소의 전체 높이를 사용 */
    }

    .filterDiv {
      line-height: normal; /* 글꼴 간격 설정 */
      font-size: 16px; /* 글꼴 크기 설정 */
      font-family: Arial, sans-serif; /* 글꼴 종류 설정 */
      max-height: 300px; /* 이미지 최대 높이 설정 */
	  padding-top: 4px;
    }

    .divTitle {
      font-size: 17px; /* 제목 글꼴 크기 설정 */
      font-weight: bold; /* 제목 글꼴 두께 설정 */
    }

    .pagination {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    .page-btn {
      margin: 0 5px;
      padding: 5px 10px;
      background-color: #f1f1f1;
      cursor: pointer;
    }

    .page-btn.active {
      background-color: #666;
      color: white;
    }
  </style>
</head>
<body>
  <!-- Control buttons -->
  <div id="myBtnContainer">
    <button class="btn all" onclick="filterSelection('all')"> Show all</button>
    <button class="btn" onclick="filterSelection('cars')"> Cars</button>
    <button class="btn" onclick="filterSelection('animals')"> Animals</button>
    <button class="btn" onclick="filterSelection('fruits')"> Fruits</button>
    <button class="btn" onclick="filterSelection('colors')"> Colors</button>
    <button class="btn" onclick="filterSelection('집공개')"> 대한민국</button> 
	
  </div>

  <!-- 검색 결과의 총 개수를 표시할 요소 -->
  <div id="searchResultCount"></div>

  <div class="container" id="dataContainer">
    <!-- Data will be dynamically added here -->
  </div>

  <div class="pagination" id="pagination">
    <!-- Pagination buttons will be dynamically added here -->
  </div>

  <script>
    const itemsPerPage = 8; // 페이지당 표시할 아이템 수
    let filteredData = {}; // 필터링된 데이터를 저장할 객체
    let currentPage = 1; // 현재 페이지 번호
    let currentFilter = 'all'; // 현재 필터

// JSON 파일 로드 함수
function loadJSON(callback) {
  const xobj = new XMLHttpRequest();
  xobj.overrideMimeType("application/json");
  xobj.open('GET', '1.json', true); // JSON 파일의 경로를 수정하세요
  xobj.onreadystatechange = function () {
    if (xobj.readyState == 4 && xobj.status == "200") {
      callback(xobj.responseText);
    }
  };
  xobj.send(null);
}

// 필터링된 데이터 미리 로드
const filters = ['all', 'cars', 'animals', 'fruits', 'colors', '집공개'];
loadJSON(function(response) {
  const jsonData = JSON.parse(response);
  filters.forEach(filter => fetchFilteredData(filter, jsonData));
  showPage(currentPage);
  renderPagination();
});


function fetchFilteredData(category, data) {
  // "all" 필터는 모든 데이터를 표시합니다.
  filteredData[category] = category === 'all' ? data : data.filter(item => {
    const categories = item.category.split(',').map(c => c.trim());
    return categories.includes(category);
  });
  updateSearchResultCount(); // 검색 결과 개수 업데이트
}



    function showPage(pageNumber) {
      // 페이지 번호에 따라 필터링된 데이터를 표시합니다.
      const startIndex = (pageNumber - 1) * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const itemsToShow = filteredData[currentFilter].slice(startIndex, endIndex);
      document.getElementById('dataContainer').innerHTML = '';
      itemsToShow.forEach(item => {
        const div = document.createElement('div');
        div.className = 'filterDiv ' + item.category; // 카테고리를 클래스로 추가
        const a = document.createElement('a');
        a.href = item.link;
        const img = document.createElement('img');
        img.src = item['img url']; // 이미지 URL 속성에 접근
        const divTitle = document.createElement('div');
        divTitle.className = 'divTitle';
        divTitle.textContent = item.title; // 제목 속성에 접근
        div.setAttribute('data-category', item.category); // 컬럼4를 데이터 속성으로 추가
        a.appendChild(img);
        a.appendChild(divTitle);
        div.appendChild(a);
        document.getElementById('dataContainer').appendChild(div);
      });
    }

    function renderPagination() {
      const totalPages = Math.ceil(filteredData[currentFilter].length / itemsPerPage);
      const paginationContainer = document.getElementById('pagination');
      paginationContainer.innerHTML = '';
      for (let i = 1; i <= totalPages; i++) {
        const pageButton = document.createElement('div');
        pageButton.classList.add('page-btn');
        pageButton.textContent = i;
        if (i === currentPage) {
          pageButton.classList.add('active');
        }
        pageButton.addEventListener('click', () => {
          currentPage = i;
          showPage(currentPage);
          updatePaginationButtons();
        });
        paginationContainer.appendChild(pageButton);
      }
    }

function filterSelection(c) {
  currentPage = 1; // 필터링 시 현재 페이지를 1로 초기화
  currentFilter = c; // 현재 필터 설정
  const buttons = document.querySelectorAll('.btn');
  buttons.forEach(button => {
    button.classList.remove('active');
  });
  event.target.classList.add('active'); // 클릭한 버튼에 'active' 클래스 추가
  console.log('Current filter:', currentFilter); // 현재 필터 확인
  showPage(currentPage);
  renderPagination();
  updateSearchResultCount(); // 검색 결과 개수 업데이트
}


    function updatePaginationButtons() {
      const paginationButtons = document.querySelectorAll('.page-btn');
      paginationButtons.forEach(button => {
        const pageNumber = parseInt(button.textContent);
        if (pageNumber === currentPage) {
          button.classList.add('active');
        } else {
          button.classList.remove('active');
        }
      });
    }

    // 검색 결과 개수를 업데이트하는 함수
    function updateSearchResultCount() {
      const totalCount = filteredData[currentFilter].length;
      document.getElementById('searchResultCount').textContent = `Search results: ${totalCount}`;
    }

    // 페이지 로딩 시 첫 번째 페이지 표시
    window.onload = function() {
      const allButton = document.querySelector('.btn.all');
      allButton.click();
    };
  </script>
</body>
</html>
